<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" />
		<style>
		p
		{
		color: blue;
		font-size: 10 px;
		}
		a
		{
			color:green;
		}
		
		#tableau_commande
		{
		  position:absolute;
      top:150px;
		  left:700px;
		}
		
		table
		{
		  border-collapse:collapse;
		}
		
		th
		{
		  border: 2px solid black;
		  text-align :center;
		}
		
		td
		{
		  border:1px solid black;
		  text-align :center;
		}
		
		.case
		{
		  width:25px;
		  height:25px;
		  background-color: gray;
		}
		
	
		</style> 
		
		<title>  Machine de Turing  </title>
		<script src="p5.min.js"></script>
	
	</head>
		
	<body>
	<header><h1> Machine de Türing virtuelle </h1></header>
		<p>  
		On pourra consulter le site de <a href="http://www.machinedeturing.com">  Marc Raynaud</a> <br/> pour voir le prototype représenté ici virtuellement.

		</p> 
		<hr />
		<div id='tableau_commande'>
		  <table>
		    <caption>Tableau de programmation</caption>
		    <!-- entête du tableau -->
		    <thead>
		      <tr>
		      <th rowspan='2'>Etat</th>
		      <th colspan='2' rowspan='2'>Lecture</th>
		      <th colspan='3'>Ecriture</th>
		      <th colspan='12'>Etat d'arrivée</th>
		    </tr>
		    <tr>
		      <th>b</th>
		      <th>0</th>
		      <th>1</th>
		      <th>1</th>
		      <th>2</th>
		      <th>3</th>
		      <th>4</th>
		      <th>5</th>
		      <th>6</th>
		      <th>7</th>
		      <th>8</th>
		      <th>9</th>
		      <th>10</th>
		      <th>11</th>
		      <th>F</th>
		    </tr>
		    </thead>
		    <!-- corps du tableau -->
		    <tbody>
		      <!-- état 1 -->
		      <tr>
		        <td rowspan='3' id='1etat'>1</td>
		        <td>b</td>
		        <td class='case' id='case0000' onclick='changeCouleur(0,0);'></td>
		        <td class='case' id='case0001' onclick='changeCouleur(0,1);'></td>
		        <td class='case' id='case0002' onclick='changeCouleur(0,2);'></td>
		        <td class='case' id='case0003' onclick='changeCouleur(0,3);'></td>
		        <td class='case' id='case0004' onclick='changeCouleur(0,4);'></td>
		        <td class='case' id='case0005' onclick='changeCouleur(0,5);'></td>
		        <td class='case' id='case0006' onclick='changeCouleur(0,6);'></td>
		        <td class='case' id='case0007' onclick='changeCouleur(0,7);'></td>
		        <td class='case' id='case0008' onclick='changeCouleur(0,8);'></td>
		        <td class='case' id='case0009' onclick='changeCouleur(0,9);'></td>
		        <td class='case' id='case0010' onclick='changeCouleur(0,10);'></td>
		        <td class='case' id='case0011' onclick='changeCouleur(0,11);'></td>
		        <td class='case' id='case0012' onclick='changeCouleur(0,12);'></td>
		        <td class='case' id='case0013' onclick='changeCouleur(0,13);'></td>
		        <td class='case' id='case0014' onclick='changeCouleur(0,14);'></td>
		        <td class='case' id='case0015' onclick='changeCouleur(0,15);'></td>
		      </tr>
		      <tr>
		        <td>0</td>
		        <td class='case' id='case0100' onclick='changeCouleur(1,0);'></td>
		        <td class='case' id='case0101' onclick='changeCouleur(1,1);'></td>
		        <td class='case' id='case0102' onclick='changeCouleur(1,2);'></td>
		        <td class='case' id='case0103' onclick='changeCouleur(1,3);'></td>
		        <td class='case' id='case0104' onclick='changeCouleur(1,4);'></td>
		        <td class='case' id='case0105' onclick='changeCouleur(1,5);'></td>
		        <td class='case' id='case0106' onclick='changeCouleur(1,6);'></td>
		        <td class='case' id='case0107' onclick='changeCouleur(1,7);'></td>
		        <td class='case' id='case0108' onclick='changeCouleur(1,8);'></td>
		        <td class='case' id='case0109' onclick='changeCouleur(1,9);'></td>
		        <td class='case' id='case0110' onclick='changeCouleur(1,10);'></td>
		        <td class='case' id='case0111' onclick='changeCouleur(1,11);'></td>
		        <td class='case' id='case0112' onclick='changeCouleur(1,12);'></td>
		        <td class='case' id='case0113' onclick='changeCouleur(1,13);'></td>
		        <td class='case' id='case0114' onclick='changeCouleur(1,14);'></td>
		        <td class='case' id='case0115' onclick='changeCouleur(1,15);'></td>
		      </tr>
		      <tr>
		        <td>1</td>
		        <td class='case' id='case0200' onclick='changeCouleur(2,0);'></td>
		        <td class='case' id='case0201' onclick='changeCouleur(2,1);'></td>
		        <td class='case' id='case0202' onclick='changeCouleur(2,2);'></td>
		        <td class='case' id='case0203' onclick='changeCouleur(2,3);'></td>
		        <td class='case' id='case0204' onclick='changeCouleur(2,4);'></td>
		        <td class='case' id='case0205' onclick='changeCouleur(2,5);'></td>
		        <td class='case' id='case0206' onclick='changeCouleur(2,6);'></td>
		        <td class='case' id='case0207' onclick='changeCouleur(2,7);'></td>
		        <td class='case' id='case0208' onclick='changeCouleur(2,8);'></td>
		        <td class='case' id='case0209' onclick='changeCouleur(2,9);'></td>
		        <td class='case' id='case0210' onclick='changeCouleur(2,10);'></td>
		        <td class='case' id='case0211' onclick='changeCouleur(2,11);'></td>
		        <td class='case' id='case0212' onclick='changeCouleur(2,12);'></td>
		        <td class='case' id='case0213' onclick='changeCouleur(2,13);'></td>
		        <td class='case' id='case0214' onclick='changeCouleur(2,14);'></td>
		        <td class='case' id='case0215' onclick='changeCouleur(2,15);'></td>
		      </tr>
		      <!-- état 2 -->
		      <tr>
		        <td rowspan='3' id='2etat'>2</td>
		        <td>b</td>
		        <td class='case' id='case0300' onclick='changeCouleur(3,0);'></td>
		        <td class='case' id='case0301' onclick='changeCouleur(3,1);'></td>
		        <td class='case' id='case0302' onclick='changeCouleur(3,2);'></td>
		        <td class='case' id='case0303' onclick='changeCouleur(3,3);'></td>
		        <td class='case' id='case0304' onclick='changeCouleur(3,4);'></td>
		        <td class='case' id='case0305' onclick='changeCouleur(3,5);'></td>
		        <td class='case' id='case0306' onclick='changeCouleur(3,6);'></td>
		        <td class='case' id='case0307' onclick='changeCouleur(3,7);'></td>
		        <td class='case' id='case0308' onclick='changeCouleur(3,8);'></td>
		        <td class='case' id='case0309' onclick='changeCouleur(3,9);'></td>
		        <td class='case' id='case0310' onclick='changeCouleur(3,10);'></td>
		        <td class='case' id='case0311' onclick='changeCouleur(3,11);'></td>
		        <td class='case' id='case0312' onclick='changeCouleur(3,12);'></td>
		        <td class='case' id='case0313' onclick='changeCouleur(3,13);'></td>
		        <td class='case' id='case0314' onclick='changeCouleur(3,14);'></td>
		        <td class='case' id='case0315' onclick='changeCouleur(3,15);'></td>
		      </tr>
		      <tr>
		        <td>0</td>
		        <td class='case' id='case0400' onclick='changeCouleur(4,0);'></td>
		        <td class='case' id='case0401' onclick='changeCouleur(4,1);'></td>
		        <td class='case' id='case0402' onclick='changeCouleur(4,2);'></td>
		        <td class='case' id='case0403' onclick='changeCouleur(4,3);'></td>
		        <td class='case' id='case0404' onclick='changeCouleur(4,4);'></td>
		        <td class='case' id='case0405' onclick='changeCouleur(4,5);'></td>
		        <td class='case' id='case0406' onclick='changeCouleur(4,6);'></td>
		        <td class='case' id='case0407' onclick='changeCouleur(4,7);'></td>
		        <td class='case' id='case0408' onclick='changeCouleur(4,8);'></td>
		        <td class='case' id='case0409' onclick='changeCouleur(4,9);'></td>
		        <td class='case' id='case0410' onclick='changeCouleur(4,10);'></td>
		        <td class='case' id='case0411' onclick='changeCouleur(4,11);'></td>
		        <td class='case' id='case0412' onclick='changeCouleur(4,12);'></td>
		        <td class='case' id='case0413' onclick='changeCouleur(4,13);'></td>
		        <td class='case' id='case0414' onclick='changeCouleur(4,14);'></td>
		        <td class='case' id='case0415' onclick='changeCouleur(4,15);'></td>
		      </tr>
		      <tr>
		        <td>1</td>
		        <td class='case' id='case0500' onclick='changeCouleur(5,0);'></td>
		        <td class='case' id='case0501' onclick='changeCouleur(5,1);'></td>
		        <td class='case' id='case0502' onclick='changeCouleur(5,2);'></td>
		        <td class='case' id='case0503' onclick='changeCouleur(5,3);'></td>
		        <td class='case' id='case0504' onclick='changeCouleur(5,4);'></td>
		        <td class='case' id='case0505' onclick='changeCouleur(5,5);'></td>
		        <td class='case' id='case0506' onclick='changeCouleur(5,6);'></td>
		        <td class='case' id='case0507' onclick='changeCouleur(5,7);'></td>
		        <td class='case' id='case0508' onclick='changeCouleur(5,8);'></td>
		        <td class='case' id='case0509' onclick='changeCouleur(5,9);'></td>
		        <td class='case' id='case0510' onclick='changeCouleur(5,10);'></td>
		        <td class='case' id='case0511' onclick='changeCouleur(5,11);'></td>
		        <td class='case' id='case0512' onclick='changeCouleur(5,12);'></td>
		        <td class='case' id='case0513' onclick='changeCouleur(5,13);'></td>
		        <td class='case' id='case0514' onclick='changeCouleur(5,14);'></td>
		        <td class='case' id='case0515' onclick='changeCouleur(5,15);'></td>
		      </tr>
		      <tr>
		        <td colspan='13' id='Fetat'>F</td>
		        </tr>
		    </tbody>
		  </table>
		</div>
			
		<!-- le dessin se trouvera dans le div défini ci-dessous -->
		<div id='monCanvas'></div>
		
	
		
		<hr />
		
		<p> en cours de modification</p>
		
	


		
		<script>
		
		// Le disque dur
		//////////////////
		var rayon=300;
		var xCentre=rayon;
		var yCentre=rayon;
		var xDecalage=rayon+50;
		var yDecalage=rayon+50;
		
		// Les disques
		///////////////
		var cote=8;
    var nbDisques=100;
   var lesDisques=new Array(nbDisques);
   // les couleurs des états
   var lesCouleurs=['white','red','green'];
     
		// créer un disque d'état et de position angulaire donnés
		function unDisque(angle,etat)
		{
		  this.angle=angle;
		  this.x=(int)((rayon-2*cote)*cos(angle));
		  this.y=(int)((rayon-2*cote)*sin(angle));
		  this.etat=etat;
		  this.couleur=lesCouleurs[etat];
		}
		
		// dessiner le disque
		unDisque.prototype.dessiner=function()
		{
		  //window.alert('coucou ('+this.x+';'+this.y+')');
		  push();
		  translate(xDecalage,yDecalage);
		  //translate((int)(cote/2),(int)(cote/2));
		  stroke('black');
		  strokeWeight((int)(cote/5));
		  //window.alert('etat ='+this.etat);
		  fill(lesCouleurs[this.etat]);
		  ellipse(this.x,this.y,2*cote,2*cote);
		  pop();
		}
		
		
		
		
		// calculer la distance entre le disque et la souris
		unDisque.prototype.distanceSouris=function()
		{
		  xCentre=this.x+cote/2;
		  yCentre=this.y+cote/2;
		  xSouris=mouseX-xDecalage;
		  ySouris=mouseY-yDecalage;
		 //window.alert('le disque : ('+xCentre+';'+yCentre+')');
		  return (xCentre-xSouris)*(xCentre-xSouris)
		  +(yCentre-ySouris)*(yCentre-ySouris);
		}
		
		// vérifie si le disque est sélectionné
		unDisque.prototype.estSelectionne=function()
		{
		  //window.alert('disque : ('+this.x+';'+this.y+')');
		  lecartSouris=this.distanceSouris();
			//window.alert(lecartSouris);
		  if (lecartSouris<50)
		  {
		    //window.alert('redessine');
		    this.etat=(this.etat+1)%3;
		    this.dessiner();
		    return true;
		  }
		  else
		  {
		    return false;
		  }
		}
		
		// change la position d'un disque
		unDisque.prototype.aGauche=function()
		{
		  this.angle=this.angle+TWO_PI/nbDisques;
		  this.x=(int)((rayon-2*cote)*cos(this.angle));
		  this.y=(int)((rayon-2*cote)*sin(this.angle));
		  this.dessiner();
		}
		
		unDisque.prototype.aDroite=function()
		{
		  this.angle=this.angle-TWO_PI/nbDisques;
		  this.x=(int)((rayon-2*cote)*cos(this.angle));
		  this.y=(int)((rayon-2*cote)*sin(this.angle));
		  this.dessiner();
		}
		
		// change l'état d'un disque
		unDisque.prototype.changeEtat=function(letat)
		{
		  this.etat=letat;
		  this.dessiner();
		}
		

		
		// Les boutons de commande
		///////////////////////////
		
		
		var btn_Droite=new unBouton(110,700,"D",'yellow');
		var btn_Gauche=new unBouton(50,700,"G",'black');
		var btn_Blanc=new unBouton(200,700,"B",'white');
    var btn_Zero=new unBouton(260,700,"0",'red');
    var btn_Un=new unBouton(320,700,"1",'green');
    var btn_Lecture=new unBouton(410,700,"L",'blue');
    var btn_ValeurLue=new unBouton(470,700," ",'white');
		
		// créer un bouton de texte modifiable et de position donnée
		function unBouton(x,y,texte,couleur)
		{
		  this.x=x;
		  this.y=y;
		  this.texte=texte;
		  this.couleur=couleur;
		}
		
		// dessiner le bouton
		unBouton.prototype.dessiner=function()
		{
		  push();
		  stroke('black');
		  fill(this.couleur);
		  rect(this.x,this.y,40,40);
		  textSize(24);
		  textAlign(LEFT);
		  fill('purple');
		  text(this.texte,this.x+10,this.y+30);
		  pop();
		}
		
		// calculer la distance entre le bouton et la souris
		unBouton.prototype.distanceSouris=function()
		{
		  xCentre=this.x+20;
		  yCentre=this.y+20;
		  xSouris=mouseX;
		  ySouris=mouseY;
		  //window.alert('souris = ('+xSouris+';'+ySouris+') pour centre = ('+xCentre+';'+yCentre+')');
		  return (xCentre-xSouris)*(xCentre-xSouris)
		  +(yCentre-ySouris)*(yCentre-ySouris);
		}
		
		// vérifie si le bouton est sélectionné
		unBouton.prototype.estSelectionne=function()
		{
			//window.alert("("+mouseX+";"+mouseY+") pour "+this.distanceSouris());
		  if (this.distanceSouris()<800)
		  {
		    //window.alert('coucou');
		    return true;
		  }
		  else
		  {
		    return false;
		  }
		}
		
		// change le texte du bouton
		unBouton.prototype.changeTexte=function(letexte)
		{
		  this.texte=letexte;
		  this.dessiner();
		}
		
		
		// Le tableau de commande
		//////////////////////////
		
		// les couleurs de case
		var couleursCases=new Array['gray','yellow'];
		var tableauCases=new Array();
		
		
		// le changement de couleur
		function changeCouleur(a,b)
		{
		  numCase="case";
		  if (a<10)
		  {
		    numCase=numCase+"0";
		  }
		  numCase=numCase+a;
		  if (b<10)
		  {
		    numCase=numCase+"0";
		  }
		  numCase=numCase+b;
		  laCase=document.getElementById(numCase);
		  tableauCases[a][b]=(tableauCases[a][b]+1)%2;
		  //window.alert('coucou '+numCase+' en '+tableauCases[a][b]);
		  if (tableauCases[a][b]==0) laCase.style.backgroundColor='gray';
		  else laCase.style.backgroundColor='yellow';
		}
		
		
		
		
		// L'animation
		////////////////////////////
		
		//var angle_base = TWO_PI / nbDisques;
		
		// La fonction de démarrage
			
	function setup()
{
  var leCanvas=createCanvas(800, 800);
  leCanvas.parent('monCanvas');
  
  
  
  // le disque dur
  push();
  translate(xDecalage,yDecalage);
  //translate(xCentre,yCentre);
  fill('#FFF168');
  noStroke();
  ellipse(0,0,rayon*2,rayon*2);
  pop();
  
  // l'horloge
  push();
  translate(xDecalage,yDecalage);
  fill('gray');
  noStroke();
  ellipse(0,0,rayon,rayon);
  fill('black');
  ellipse(0,0,rayon/10,rayon/10);
  pop();
  
  // l'aiguille
   push();
  translate(xDecalage,yDecalage);
  strokeWeight(10);
  fill('black');
  line(0,0,rayon/4,rayon/4);
  pop();
  
  // le repère de lecture
   push();
	translate(xDecalage,yDecalage);
	strokeWeight(8);
	fill('black');
  line(rayon+cote,0,rayon+3*cote,0);
  pop();
  
  
  // les cylindres
  var angle_base = TWO_PI / nbDisques;
  for (var i=0;i<nbDisques;i++)
  {
    lesDisques[i]=new unDisque(angle_base*i,0);
    
    lesDisques[i].dessiner();
  }
  
  
  // les boutons
  textSize(24);
	textAlign(LEFT);
	fill('purple');
  // les boutons de déplacement
  text("Déplacement",30,680);
  btn_Droite.dessiner();
  btn_Gauche.dessiner();
  // les boutons d'écriture'
  text("Ecriture",240,680);
  btn_Blanc.dessiner();
  btn_Zero.dessiner();
  btn_Un.dessiner();
  // le bouton de lecture
  text("Lecture",410,680);
  btn_Lecture.dessiner();
  btn_ValeurLue.dessiner();
  
  
  // le tableau de commande
  	// le tableau des cases
		// nombre d'état affichés sauf F
		var nbEtats=2;
	 tableauCases=new Array(nbEtats*3);
  // mets les cases à 0

  for (i=0;i<nbEtats*3;i++) 
		{
		  tableauCases[i]=new Array(16);
		  for (j=0;j<16;j++) 
		  {
		    tableauCases[i][j]=0;
		  }
		
		}
		
		
 }
 

  // La fonction qui tourne en boucle
function draw() 
{
  
}

 // quand la souris est enfoncée
  function mousePressed()
  {
    
    // test de la position de la souris
    //window.alert('souris ('+mouseX+';'+mouseY+')');
   // window.alert('repère ('+(mouseX-xDecalage)+';'+(mouseY-yDecalage)+')');
    
    // teste si un disque est dessous
    for (i=0;i<nbDisques;i++)
    {
      lesDisques[i].estSelectionne();
    }
    
    // teste si le bouton gauche est sélectionné et décale vers la gauche
    if (btn_Gauche.estSelectionne())
    {
      // remet le bouton de lecture à zéro
      btn_ValeurLue.changeTexte(" ");
      
      for (i=0;i<nbDisques;i++)
      {
        lesDisques[i].aGauche();
      }
      
    }
    
    // teste si le bouton droite est sélectionné et décale vers la droite
    if (btn_Droite.estSelectionne())
    {
      // remet le bouton de lecture à zéro
      btn_ValeurLue.changeTexte(" ");
      
      for (i=0;i<nbDisques;i++)
      {
        lesDisques[i].aDroite();
      }
      
    }
    
    // teste quel bouton d'écriture est sélectionné et change l'état
    if (btn_Blanc.estSelectionne())
    {
      // remet le bouton de lecture à zéro
      btn_ValeurLue.changeTexte(" ");
      
      // détecte le bouton sur la zone de lecture/écriture
      for (i=0;i<nbDisques;i++)
      {
        // je teste l'abscisse et non l'angle pour éviter le modulo 2π
        if (lesDisques[i].x==284) lesDisques[i].changeEtat(0);
      }
    }
    
    if (btn_Zero.estSelectionne())
    {
      // remet le bouton de lecture à zéro
      btn_ValeurLue.changeTexte(" ");
      
      // détecte le bouton sur la zone de lecture/écriture
      for (i=0;i<nbDisques;i++)
      {
        // je teste l'abscisse et non l'angle pour éviter le modulo 2π
        if (lesDisques[i].x==284) lesDisques[i].changeEtat(1);
      }
    }
    
    if (btn_Un.estSelectionne())
    {
      // remet le bouton de lecture à zéro
      btn_ValeurLue.changeTexte(" ");
      
      // détecte le bouton sur la zone de lecture/écriture
      for (i=0;i<nbDisques;i++)
      {
        // je teste l'abscisse et non l'angle pour éviter le modulo 2π
        if (lesDisques[i].x==284) lesDisques[i].changeEtat(2);
      }
    }
    
    
    // lecture
    
    if (btn_Lecture.estSelectionne())
    {
      // détecte le bouton sur la zone de lecture/écriture
      for (i=0;i<nbDisques;i++)
      {
        var sonTexte=" ";
        // je teste l'abscisse et non l'angle pour éviter le modulo 2π
        if (lesDisques[i].x==284) 
        {
          if (lesDisques[i].etat==0) sonTexte="B";
          if (lesDisques[i].etat==1) sonTexte="0";
          if (lesDisques[i].etat==2) sonTexte="1";
          btn_ValeurLue.changeTexte(sonTexte);
        }
      }
    }
    
    
  }
  
 



		</script>
	</body>
</html>
